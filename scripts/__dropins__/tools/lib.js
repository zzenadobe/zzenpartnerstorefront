/*! Copyright 2025 Adobe
All Rights Reserved. */
import{d as M,S as v}from"./chunks/deviceUtils.js";import{R as Y,V as Z,c as x,a as ee,g as re,b as te,i as ne}from"./chunks/deviceUtils.js";import{C as se,I as ie,i as le}from"./chunks/initializer.js";import{jsx as E}from"./preact-jsx-runtime.js";import{x as O,A as C,h as P,T as $,E as _,q as p,y as D}from"./chunks/icons/Add.js";import{IntlContext as V}from"./i18n.js";import{g as ae,s as ce}from"./chunks/image-params-keymap.js";import"./signals.js";const k=r=>{const n=new FormData(r);return Object.fromEntries(n)},A=r=>{const n=new FormData(r),l=Object.fromEntries(n);return Object.entries(l).reduce((s,[d])=>{const o=r.elements[d];return o!=null&&o.validationMessage?{...s,[d]:o.validationMessage}:{...s}},{})},F={arrayMerge:(r,n,l)=>{const c=r.slice();return n.forEach((s,d)=>{typeof c[d]>"u"?c[d]=l.cloneUnlessOtherwiseSpecified(s,l):l.isMergeableObject(s)?c[d]=M(r[d],s,l):r.indexOf(s)===-1&&c.push(s)}),c}};function U(r,n){return n?M(r,n,F):r}const W=r=>r.replace("_","-");function T(r,n={},l,c,s){const d=O(v),o=C(null),S=C("pending"),w=C([]),[y,R]=P({children:[c]}),[I,j]=P({}),N=$(()=>({get:t=>I[t],set:(t,e)=>{j({...N,[t]:e})}}),[I]),{intl:B}=O(V);n.dictionary=B.dictionary,n._setProps=t=>{R(e=>{const i=typeof t=="function"?t(e):t;if(s){const a=_(s(e),{key:"render"}),f=e.children.findIndex(g=>(g==null?void 0:g.key)==="render");e.children[f]=a}return i})};const u=p(t=>{typeof t=="function"?w.current.push(t):console.warn("Skipped: Invalid _registerMethod",t)},[]);n._registerMethod=u;const h=p(t=>E("div",{"data-slot-html-element":t.tagName.toLowerCase(),ref:e=>{e==null||e.appendChild(t)}}),[]);n._htmlElementToVNode=h,n.getSlotElement=p(t=>{var i,a;const e=(i=o.current)==null?void 0:i.querySelector(`[data-slot-key="${t}"]`);if(m(`ðŸŸ¦ "${r}" Slot getSlotElement: ${t}`,(a=o.current)==null?void 0:a.cloneNode(!0),e==null?void 0:e.cloneNode(!0)),!!e)return{appendChild:f=>{e.appendChild(f)},prependChild:f=>{e.insertBefore(f,e.firstChild)},appendSibling:f=>{const g=e.parentNode;g==null||g.insertBefore(f,e.nextSibling)},prependSibling:f=>{const g=e.parentNode;g==null||g.insertBefore(f,e)}}},[r]),n.onRender=p(t=>{w.current.push(t)},[]),n.onChange=n.onRender,n.replaceWith=p(t=>{u(e=>{const i=h(t);e._setProps({children:[i]})})},[h,u]),n.appendChild=p(t=>{u(e=>{const i=h(t);e._setProps(a=>({...a,children:[...a.children,i]}))})},[h,u]),n.prependChild=p(t=>{u(e=>{const i=h(t);e._setProps(a=>({...a,children:[i,...a.children]}))})},[h,u]),n.appendSibling=p(t=>{u(()=>{var i,a;const e=(i=o.current)==null?void 0:i.parentNode;e==null||e.insertBefore(t,((a=o.current)==null?void 0:a.nextSibling)??null)})},[u]),n.prependSibling=p(t=>{u(()=>{var i;const e=(i=o.current)==null?void 0:i.parentNode;e==null||e.insertBefore(t,o.current)})},[u]);const b=p(async()=>{if(S.current==="loading")return;S.current="loading",m(`ðŸŸ¨ "${r}" Slot Rendered`);const t=s?_(s(y),{key:"render"}):null;R({children:[t??c]}),w.current.forEach(e=>{e(n,N)}),S.current="ready"},[c,n,r,y,s,N]),L=p(async()=>{if(l)try{S.current="loading",m(`ðŸŸ© "${r}" Slot Initialized`),await l(n,o.current)}catch(t){console.error(`Error in "${l.name}" Slot callback`,t)}finally{S.current="ready",await b()}},[l,n,b,r]);return D(()=>{L().finally(()=>{d&&(d.value.delete(r),d.value=new Set(d.value))})},[]),D(()=>{b()},[JSON.stringify(n),JSON.stringify(I)]),[o,y]}function G({name:r,context:n,slot:l,children:c,render:s,...d}){const o=O(v),[S,w]=T(r,n,l,c,s);return $(()=>{if(!r)return console.warn('Slot "name" is required');o&&(o.value.add(r),o.value=new Set(o.value))},[r,o]),E("div",{...d,ref:S,"data-slot":r,children:w.children})}window.DROPINS=window.DROPINS||{};window.DROPINS.showSlots=async r=>{window.sessionStorage.setItem("dropin-debugger--show-slots",r.toString()),document.body.classList.toggle("dropin-debugger--show-slots",r)};let m=()=>{};window.DROPINS.logSlots=async r=>{window.sessionStorage.setItem("dropin-debugger--log-slots",r.toString()),m=r?(...n)=>console.log(...n):()=>{}};window.DROPINS.showSlots(window.sessionStorage.getItem("dropin-debugger--show-slots")==="true");window.DROPINS.logSlots(window.sessionStorage.getItem("dropin-debugger--log-slots")==="true");export{se as Config,ie as Initializer,Y as Render,G as Slot,v as SlotQueueContext,Z as VComponent,x as classes,ee as debounce,M as deepmerge,re as generateSrcset,A as getFormErrors,k as getFormValues,ae as getImageParamsKeyMap,le as initializers,te as isIOSMobileDevice,ne as isNumber,U as merge,ce as setImageParamsKeyMap,W as toLanguageTag,T as useSlot};
